<head>
    <link rel="icon" type="image/x-icon" href="favicon.png">
</head>
<html>
    <body style='display: flex; justify-content:center; align-items: end;'>
        <input id='password' type='text' size='50' placeholder="t a l a ' l j  k I" title="Hmm" onkeydown='search(this)' oninput='onInput(this)' />
    </body>

</html>

<script>
    document.title = "Meglepi";
    const
        day = 22,
        month = 10
        year = 2022
        from = (new Date(`${year}-${month}-${day} 16:30:00`)).getTime(),
        colors = ['purple', 'green', 'orange'],
        notColors = ['white', 'black', 'gray'],
        fonts = ['Impact', 'Comic Sans MS', 'Calibri', 'Consolas', 'Courier New'],
        words = ['hazasok'],
        fadeInterval = 7,
        jelszo = Date(),
        getTime = divisor => (Math.abs(((new Date()).getTime() - from)) / divisor).toFixed(2),
        things = ['caca', 'majom', 'tapolcaiak', 'kutya', 'caca'],
        time =
        [
            [1000, ['mperc', 'gomboc']],
            [1000 * 60, ['perc', 'ido']],
            [1000 * 60 * 60, ['ora', 'szam']],
            [1000 * 60 * 60 * 24, ['nap', Next(things)]],
            [1000 * 60 * 60 * 24 * 7, ['het', 'kaposzta']],
            [1000 * 60 * 60 * 24 * 30, ['ho', 'szesz']],
            [1000 * 60 * 60 * 24 * 365, ['ev', 'harom']]
        ]

    var jelszokerdojel,
        grat = false,
        nowGrat = false

    function onInput(input) {
        jelszokerdojel = input.value
    }

    function palindrom(str) {
        return str == str.split('').reverse().join('');
    }

    function search(input) {
        if (event.key === 'Enter') {

            if (jelszokerdojel === `${year}${month}${day}` + formatDate(Date())) {
                grat = true
                document.getElementById("password").placeholder = "m e ' g  k e ' n e  v a l a m I"
            }

            if (grat) {
                if (palindrom(jelszokerdojel)) {
                    nowGrat = true;
                    document.body.style.backgroundImage = 'url(background.bmp)'
                    document.body.removeChild(document.getElementById('password'))
                }
            }

            jelszokerdojel = "";
            input.value = "";
        }
    }

    /*public async Task<*/function/*>*/ Next(items)
    {
        return items[Math.floor(Math.random() * items.length)];
    }

    for (let i = 0; i < time.length; i++) {
        window.setTimeout(_ => telefonfulke(() => [getTime(time[i][0]), time[i][1] ], fadeInterval), i * 1000)
    }

    var telefonfulke = (getValue, fadeInterval) => {
        setInterval(_ => { show(getValue, fadeInterval) }, fadeInterval * 1000)
    }

    function show(getValue, fadeInterval) {
        let timeElement = document.createElement("p")
        let timeElementStyle = timeElement.style

        let value = getValue();
        timeElement.innerText = grat ? `${value[0]} ${nowGrat ? value[1][0] : value[1][1]}` : value[0]
        timeElementStyle.color = `${grat ? Next(colors) : Next(notColors)}`
        timeElementStyle.fontFamily = grat ? 'Impact' : Next(fonts)
        timeElementStyle.transform = `rotate(${Math.random() * 30 - 20}deg)`
        timeElementStyle.animation = `fade ${fadeInterval}s linear infinite`
        timeElementStyle.fontSize = `${Math.random() * 5 + 5}em`
        timeElementStyle.right = Math.floor(Math.random() * (window.innerWidth - timeElement.clientWidth)) - 50;
        timeElementStyle.bottom = Math.floor(Math.random() * (window.innerHeight - timeElement.clientHeight))
        timeElementStyle.opacity = 0.7

        document.body.appendChild(timeElement)
        window.setTimeout(_ => document.body.removeChild(timeElement), fadeInterval * 1000)

        if (!grat) {
            let timeElement = document.createElement("p")
            timeElementStyle = timeElement.style

            timeElement.innerText = value[1][1]
            timeElementStyle.color = `${grat ? Next(colors) : Next(notColors)}`
            timeElementStyle.fontFamily = grat ? 'Impact' : Next(fonts)
            timeElementStyle.transform = `rotate(${Math.random() * 30 - 20}deg)`
            timeElementStyle.animation = `fade ${fadeInterval}s linear infinite`
            timeElementStyle.fontSize = `${Math.random() * 5 + 5}em`
            timeElementStyle.right = Math.floor(Math.random() * (window.innerWidth - timeElement.clientWidth) + 2 * timeElement.clientWidth)
            timeElementStyle.bottom = Math.floor(Math.random() * (window.innerHeight - timeElement.clientHeight) - 2 * timeElement.clientHeight)
            timeElementStyle.opacity = 0.7;

            document.body.appendChild(timeElement)
            window.setTimeout(_ => document.body.removeChild(timeElement), fadeInterval * 1000)
        }

    }

    // Thanks user3470953 https://stackoverflow.com/questions/23593052/format-javascript-date-as-yyyy-mm-dd <3 <3
    function formatDate(date) {
        var d = new Date(date),
            minute = '' + d.getMinutes()
            hour = '' + d.getHours()

        if (minute.length < 2)
            minute = '0' + minute;

        if (hour.length < 2)
            hour = '0' + hour;

        return `${hour}${minute}`;
    }

</script>

<style>
    #password {
        margin-bottom: 20px;
        line-height: 3em;
        background: black;
        color: transparent;
        text-align: center;
        font-family: 'Courier New';
        font-weight: bolder;
        font-size: 2em;
    }

    ::selection {
        background-color: black;
    }

    p {
        position: absolute;
        font-size: 5em;
        font-weight: bold;
    }

    body {
        background-image: url('sepia_background.bmp');
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-size: cover;
        background-position: center;
        background-color: #f7fcff;
    }

    @keyframes fade {
        0% {
            opacity: 0
        }

        50% {
            opacity: 1
        }

        100% {
            opacity: 0
        }
    }
</style>

